# 测试数据说明

## 概述

本文档说明项目中已预置的测试数据，用于本地测试和开发。

## 测试任务数据

### 任务列表

| 任务ID | 任务名称 | 创建人 | 状态 | 扫描助手版本 | 代码仓地址 |
|--------|---------|--------|------|-------------|-----------|
| task-001 | Spring Boot项目代码扫描 | zhangsan | COMPLETED | v1.2.0 | https://github.com/example/spring-boot-demo.git |
| task-002 | 微服务架构代码审查 | lisi | SCANNING | v1.3.0 | https://github.com/example/microservice-app.git |
| task-003 | 前端代码质量检查 | wangwu | CREATED | v1.1.0 | https://github.com/example/frontend-app.git |
| task-004 | API接口代码扫描 | zhangsan | COMPLETED | v1.2.0 | https://github.com/example/api-service.git |
| task-005 | 数据库访问层扫描 | zhaoliu | FAILED | v1.0.0 | https://github.com/example/data-access.git |

### 任务状态说明

- **CREATED**: 已创建，等待扫描
- **SCANNING**: 扫描中
- **COMPLETED**: 扫描完成
- **FAILED**: 扫描失败

## 扫描结果数据

### 任务1 (task-001) - 6条扫描结果

包含不同类型的缺陷和标注状态：

1. **空指针风险** - 已标注为问题 (isIssue=true, marker=zhangsan)
2. **资源未关闭** - 已标注为问题 (isIssue=true, marker=zhangsan)
3. **硬编码字符串** - 已标注为非问题 (isIssue=false, marker=lisi)
4. **SQL注入风险** - 未标注 (isIssue=null)
5. **未使用的导入** - 已标注为非问题 (isIssue=false)
6. **测试覆盖率不足** - 未标注 (isIssue=null)

### 任务2 (task-002) - 2条扫描结果

扫描中任务的部分结果，均未标注：
- 循环依赖
- 密码硬编码

### 任务4 (task-004) - 3条扫描结果

全部已标注：
- 缺少参数验证 - 已标注为问题
- 异常处理不当 - 已标注为问题
- 日期格式化线程不安全 - 已标注为非问题

## 测试接口示例

### 1. 查询所有任务
```bash
GET http://localhost:8080/api/tasks
```

### 2. 查询zhangsan创建的任务
```bash
GET http://localhost:8080/api/tasks?creator=zhangsan
```

### 3. 查询任务详情
```bash
GET http://localhost:8080/api/tasks/task-001
```

### 4. 查询任务扫描结果
```bash
GET http://localhost:8080/api/scan-results?taskId=task-001
```

### 5. 查询任务统计信息
```bash
GET http://localhost:8080/api/scan-results/statistics?taskId=task-001
```

### 6. 标注扫描结果
```bash
PUT http://localhost:8080/api/scan-results/{id}/mark
Content-Type: application/json

{
  "isIssue": true,
  "marker": "test_user"
}
```

### 7. 获取任务详细信息（包含统计看板）
```bash
GET http://localhost:8080/api/task-details/task-001
```

## PowerShell 测试脚本

```powershell
# 1. 查询所有任务
Invoke-RestMethod -Uri "http://localhost:8080/api/tasks" -Method Get

# 2. 查询zhangsan的任务
Invoke-RestMethod -Uri "http://localhost:8080/api/tasks?creator=zhangsan" -Method Get

# 3. 查询任务详情
Invoke-RestMethod -Uri "http://localhost:8080/api/tasks/task-001" -Method Get

# 4. 查询任务扫描结果
Invoke-RestMethod -Uri "http://localhost:8080/api/scan-results?taskId=task-001" -Method Get

# 5. 查询统计信息
Invoke-RestMethod -Uri "http://localhost:8080/api/scan-results/statistics?taskId=task-001" -Method Get

# 6. 标注扫描结果（假设ID为1）
$body = @{
    isIssue = $true
    marker = "test_user_001"
} | ConvertTo-Json
Invoke-RestMethod -Uri "http://localhost:8080/api/scan-results/1/mark" -Method Put -Body $body -ContentType "application/json"

# 7. 获取任务详细信息
Invoke-RestMethod -Uri "http://localhost:8080/api/task-details/task-001" -Method Get
```

## 数据统计示例

### 任务1 (task-001) 的统计信息

- **总缺陷数**: 6
- **缺陷类型分布**:
  - 空指针风险: 1
  - 资源未关闭: 1
  - 硬编码字符串: 1
  - SQL注入风险: 1
  - 未使用的导入: 1
  - 测试覆盖率不足: 1
- **标记状态统计**:
  - 未标注: 2
  - 已标注为问题: 2
  - 已标注为非问题: 2

## 注意事项

1. 测试数据在应用启动时自动加载（通过schema.sql）
2. 使用H2内存数据库，应用重启后数据会重置
3. 所有时间戳使用固定值，便于测试
4. 部分扫描结果包含中文内容，确保数据库支持UTF-8编码
